var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Page=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStageFunc,t),t}return __extends(t,e),t.prototype.onAddToStageFunc=function(){this.width=this.stage.stageWidth,this.height=this.stage.stageHeight,this.x=this.anchorOffsetX=this.width/2,this.y=this.anchorOffsetY=this.height/2,this.onPreInit()},t.prototype.onPreInit=function(e){void 0===e&&(e=!0),this.touchEnabled=!0;var t=new egret.Shape;t.graphics.beginFill(0,.01),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),this.addChild(t),e&&this.init()},t.prototype.changePage=function(e){var t=this;if(null!=this.parent){var i=function(e){for(var t=0;t<e.numChildren;t++)egret.Tween.removeTweens(e.getChildAt(t)),null!=e.mask&&(e.mask.parent.removeChild(e.mask),e.mask=null),e instanceof egret.DisplayObjectContainer&&i(e.getChildAt(t)),e instanceof egret.MovieClip&&e.stop()};i(this),e.alpha=0,e.scaleX=e.scaleY=1.3,this.parent.addChild(e),egret.Tween.get(this).to({alpha:0,scaleX:.5,scaleY:.5},500,egret.Ease.cubicOut),egret.Tween.get(e).to({alpha:1,scaleX:1,scaleY:1},500,egret.Ease.cubicOut).call(function(){null!=t.parent&&t.parent.removeChild(t)},this)}},t.prototype.createBitmap=function(e,t){void 0===t&&(t=!1);var i=new egret.Bitmap(RES.getRes(e));return t&&(i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2),i},t.prototype.createBtn=function(e,t){var i=this.createBitmap(e,!0);return i.x=this.width/2,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){CommonUtil.buttonTap(i,function(){t&&null!=t&&t()})},this),i},t.prototype.createArm=function(e){var t=new dragonBones.EgretFactory;t.parseDragonBonesData(RES.getRes(e+"_ske.json")),t.parseTextureAtlasData(RES.getRes(e+"_tex.json"),RES.getRes(e+"_tex.png"));var i=t.buildArmatureDisplay(e);return i},t.prototype.createBitmapByUrl=function(e,t,i){void 0===i&&(i=!1),RES.getResByUrl(e,function(e){var n=new egret.Bitmap(e);i&&(n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2),t(n)},this,RES.ResourceItem.TYPE_IMAGE)},t.prototype.createMovieClip=function(e){var t=new egret.MovieClipDataFactory(RES.getRes(e+".json"),RES.getRes(e+".png")),i=new egret.MovieClip(t.generateMovieClipData(e));return i},t}(egret.DisplayObjectContainer);__reflect(Page.prototype,"Page");var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){var t=this;$.ajax({url:"/_assets/touch/activity/third/prince/resource/default.res.json",dataType:"json",success:function(e){t.onConfigComplete(e)}})},t.prototype.onConfigComplete=function(e){var t=this,i={groups:[{keys:"",name:"preload"}],resources:[]};i.resources=e.resources;var n=["pop","doorlight","monsterred","monsterbox","monsteryellow","listsky","listclock","monsterphone","monsterwater"];for(var a in n)i.resources.push({name:n[a]+"_ske.json",type:"json",url:n[a]+"_ske.json"},{name:n[a]+"_tex.json",type:"json",url:n[a]+"_tex.json"},{name:n[a]+"_tex.png",type:"image",url:n[a]+"_tex.png"});for(var r=1;11>=r;r++)i.resources.push({name:"E-mail-two_"+(10>r?"0"+r:r)+"_01.png",type:"image",url:"E-mail-two_"+(10>r?"0"+r:r)+"_01.png"},{name:"E-mail-two_"+(10>r?"0"+r:r)+"_01.json",type:"json",url:"E-mail-two_"+(10>r?"0"+r:r)+"_01.json"});for(var r=1;46>=r;r++){for(var o=r.toString();o.length<2;)o="0"+o;i.resources.push({name:"cbl_wait_"+o,type:"image",url:"cbl_wait/cbl_wait_"+o+".png"})}for(var r=1;40>=r;r++){for(var o=r.toString();o.length<2;)o="0"+o;i.resources.push({name:"cbl_look_"+o,type:"image",url:"cbl_look/cbl_look_"+o+".png"})}for(var r=0;r<i.resources.length;r++)i.groups[0].keys+=","+i.resources[r].name;RES.parseConfig(i,"./resource/"),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.loadingView=new LoadingUI,this.addChild(this.loadingView),this.loadingView.ok=function(){t.createGameScene()}},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this))},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.createGameScene=function(){var e=this;soundManager.play("bgm"),audioBtnShowFunc(),officePageObj.doAni(),writeFlag=!1;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),t.alpha=0,showMB=function(){t.alpha=0,e.addChildAt(t,e.numChildren-1),egret.Tween.get(t).to({alpha:1},500)},hideMB=function(){t.alpha=1,egret.Tween.get(t).to({alpha:0},500).call(function(){t.parent.removeChild(t)})}},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var LoadingUI=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.proText=["告白邮局开始建造…...","告白邮局正在打地基……","告白邮局正在垒砖墙…...","告白邮局正在盖房顶……","告白邮局正在装水暖…...","告白邮局正在安门窗…...","告白邮局正在刮腻子……","告白邮局正在精装修……","告白邮局开业了。"],t}return __extends(t,e),t.prototype.init=function(){var e=this;this.inited||(this.inited=!0,this.textField=new egret.TextField,this.textField.width=this.width,this.textField.height=300,this.textField.anchorOffsetX=this.textField.width/2,this.textField.anchorOffsetY=this.textField.height/2,this.textField.x=.5*this.width,this.textField.y=.6*this.height,this.textField.textAlign=egret.HorizontalAlign.CENTER,this.textField.verticalAlign=egret.VerticalAlign.MIDDLE,this.textField.textColor=16777215,this.textField.strokeColor=0,this.textField.stroke=2,this.textField.size=32,this.textField.text="0%",RES.getResAsync("loadingbgcolor",function(){RES.getResAsync("loadingbggray",function(){var t=e.createBitmap("loadingbgcolor");t.width=e.width,t.height=e.height,e.addChild(t),e.addChild(e.textField),RES.loadGroup("preload")},e)},this))},t.prototype.setProgress=function(e,t){var i=this,n=this.parent,a=this.proText[Math.floor(e/t*this.proText.length)];if(this.textField.text=Math.floor(e/t*100)+"%\n\n\n"+a,e==t){console.log("100%"),this.textField.text="走近点看看";var r=document.getElementById("vBox"),o=document.getElementById("v");this.once(egret.TouchEvent.TOUCH_BEGIN,function(){var e=RES.getRes("buttonSound").play(0,1);e.stop(),o.load();var t=function(){r.style.display="block",o.style.display="block";var e=function(){i.ok&&i.ok(),r.style.display="none",o.style.display="none",$(o).remove(),soundManager.resumeAll(),o.removeEventListener("ended",e,!0)};o.addEventListener("ended",e,!0),o.addEventListener("pause",function(){o.currentTime>=o.duration||(r.style.display="none",o.style.display="none",o.removeEventListener("ended",e,!0),n.addChild(i),i.textField.text="点击继续",i.once(egret.TouchEvent.TOUCH_BEGIN,function(){t()},i))},!0),o.play(),egret.setTimeout(function(){n.removeChild(i),i.oked||(officePageObj=new OfficePage,n.addChild(officePageObj),i.oked=!0)},i,1e3)};t()},this)}},t}(Page);__reflect(LoadingUI.prototype,"LoadingUI");var MailGetPage=function(e){function t(t){var i=e.call(this)||this;return i.inited=!1,i.mail=t,i}return __extends(t,e),t.prototype.init=function(){var e=this;this.inited||(this.inited=!0,showMB(),this.createBitmapByUrl(this.mail.picUrl,function(t){e.createBitmapByUrl(e.mail.headImgUrl,function(i){var n=e.showData(e.mail.to,e.mail.content,e.mail.from,i,t);if(n.scaleX=n.scaleY=.5,egret.Tween.get(n).to({scaleX:1,scaleY:1},500,egret.Ease.backOut),n.height<e.height)n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=e.width/2,n.y=e.height/2,e.addChild(n);else{n.anchorOffsetX=n.width/2,n.x=e.width/2;var a=new egret.ScrollView;a.setContent(n),a.width=e.width,a.height=e.height,n.y=.1*e.height,n.height+=.2*e.height,e.addChild(a)}var r=e.createBtn("mail.btnclose",function(){egret.Tween.get(e).to({scaleX:.5,scaleY:.5,alpha:0},500,egret.Ease.backIn).call(function(){e.parent.removeChild(e)}),hideMB()});r.x=e.width-70,r.y=100,e.addChild(r)})}))},t.prototype.showData=function(e,t,i,n,a){var r=this,o=new egret.Sprite,h=this.createBitmap("mail.bgget");o.width=h.width,h.scale9Grid=new egret.Rectangle(0,30,h.width,h.height-60);var l=new egret.Sprite;l.width=450,l.anchorOffsetX=l.width/2,l.x=o.width/2,l.y=90;var s=0;a.scaleX=a.scaleY=l.width/a.width,a.y=s,s+=a.height*a.scaleY+30;var d=new egret.TextField;d.text="To:",d.x=30,d.y=s,d.width=100,d.height=60,d.size=56,d.textColor=3430012,d.textAlign=egret.HorizontalAlign.LEFT,d.verticalAlign=egret.VerticalAlign.MIDDLE,s+=d.height+30;var c=new egret.TextField;c.text=e,c.x=d.x+d.width+20,c.y=d.y,c.width=270,c.size=42,c.height=60,c.textColor=6710886,c.textAlign=egret.HorizontalAlign.LEFT,c.verticalAlign=egret.VerticalAlign.MIDDLE;var g=new egret.Shape;g.graphics.lineStyle(1,13421772,1),g.graphics.moveTo(0,0),g.graphics.lineTo(c.width+20,0),g.graphics.endFill(),g.x=c.x-10,g.y=c.y+c.height;var u=new egret.TextField;u.multiline=!0,u.lineSpacing=20,u.size=36,u.text=t,u.width=l.width,u.textColor=6710886,u.height=u.numLines*(u.size+u.lineSpacing),u.y=s,s+=u.height+20;var p=new egret.Shape;p.graphics.lineStyle(1,13421772,1);for(var f=0;f<u.numLines;f++){var m=(f+1)*u.height/u.numLines-10;p.graphics.moveTo(0,m),p.graphics.lineTo(u.width,m)}p.graphics.endFill(),p.y=u.y;var w=new egret.Shape;w.graphics.beginFill(0,1),w.graphics.drawCircle(0,0,50),w.graphics.endFill(),w.x=l.width-50,w.y=s+50,s+=w.height+20,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.y=w.y,n.x=w.x,n.width>n.height?n.scaleX=n.scaleY=100/n.height:n.scaleX=n.scaleY=100/n.width,n.mask=w;var v=new egret.TextField;v.text="From:"+i,v.textAlign=egret.HorizontalAlign.RIGHT,v.verticalAlign=egret.VerticalAlign.MIDDLE,v.width=l.width,v.y=s,v.size=32,v.height=v.size,v.textColor=6704437,s+=v.height+20,l.addChild(a),l.addChild(d),l.addChild(c),l.addChild(g),l.addChild(p),l.addChild(u),l.addChild(n),l.addChild(w),l.addChild(v),this.contentBox=l,o.height=s+90+60+30,h.height=o.height;var y=this.createBtn("mail.btnget",function(){writeFlag?r.btnFunc():r.showMsg(),y.touchEnabled=!0});y.x=.3*o.width,y.y=o.height-20;var x=this.createBtn("mail.btnshare",function(){x.touchEnabled=!0,r.showShareTip()});return x.x=.7*o.width,x.y=o.height-20,o.addChild(h),o.addChild(l),o.addChild(y),o.addChild(x),o},t.prototype.btnFunc=function(){var e=this;apiObj.getMail(this.mail,function(t){if(t){var i=new egret.RenderTexture;i.drawToTexture(e.contentBox,new egret.Rectangle(0,0,e.contentBox.width,e.contentBox.height)),e.changePage(new MailGetSuccessPage(i,e.mail))}else alert("取走失败！")})},t.prototype.showMsg=function(){var e=this,t=new egret.DisplayObjectContainer;t.touchEnabled=!0;var i=new egret.Shape;i.graphics.beginFill(0,.7),i.graphics.drawRect(0,0,this.width,this.height),i.graphics.endFill(),i.alpha=0,egret.Tween.get(i).to({alpha:1},1e3);var n=this.createBitmap("mail.cbl");n.anchorOffsetY=n.height,n.y=this.height,n.x=-n.width;var a=this.createBitmap("mail.cblmsg");a.anchorOffsetY=a.height,a.anchorOffsetX=115,a.y=n.y-n.height,a.x=n.x+n.width/2,a.rotation=-50,a.alpha=0,egret.Tween.get(n).to({x:0},500,egret.Ease.backOut).call(function(){a.x=.4*n.width,egret.Tween.get(a).to({alpha:1,rotation:0},500,egret.Ease.backOut)}),a.touchEnabled=!0,a.once(egret.TouchEvent.TOUCH_TAP,function(){var i=new MailWritePage;i.onClose=function(){i.parent.addChild(e),i.parent.removeChild(i)},e.parent.addChild(i),e.parent.removeChild(e),t.parent.removeChild(t)},this),t.addChild(i),t.addChild(n),t.addChild(a),this.addChild(t)},t.prototype.showShareTip=function(){var e=this,t=new egret.DisplayObjectContainer;t.touchEnabled=!0,t.alpha=0,egret.Tween.get(t).to({alpha:1},500).call(function(){t.once(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t)},e)});var i=this.createBitmap("sharebg");i.height=this.height;var n=this.createBitmap("sharetip");n.anchorOffsetX=n.width,n.x=this.width-30,n.y=30,t.addChild(i),t.addChild(n),this.addChild(t)},t}(Page);__reflect(MailGetPage.prototype,"MailGetPage");var MailGetSuccessPage=function(e){function t(t,i){var n=e.call(this)||this;return n.RenderTexture=t,n.mail=i,n}return __extends(t,e),t.prototype.init=function(){var e=new egret.Sprite,t=new egret.TextField;t.y=.1*this.height,t.width=this.width,t.textAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.TOP,t.textColor=16777215,t.size=28,t.lineSpacing=20,t.textFlow=(new egret.HtmlTextParser).parser("<font size=70>  成功取走！</font>"+(this.mail.wechatId?"\n\n寄件人留下了TA的 联系方式\n你可以联系他 给他回信\n\n<i>微信号：<b>"+this.mail.wechatId+"</b></i>":"")+"\n\n长按下面图片保存图片可以分享至朋友圈"),t.height=t.numLines*(t.size+t.lineSpacing)+35;var i=new egret.Sprite,n=this.createBitmap("mail.bggetsuccess");n.scale9Grid=new egret.Rectangle(0,50,n.width,1e3);var a=new egret.Bitmap(this.RenderTexture);i.width=n.width,i.height=a.height+320,i.anchorOffsetX=i.width/2,i.x=this.width/2,n.height=i.height,n.anchorOffsetX=n.width/2,n.x=i.width/2,a.anchorOffsetX=a.width/2,a.x=i.width/2,a.y=50,i.addChild(n),i.addChild(a),i.y=t.y+t.height,e.height=t.y+t.height+i.height,e.addChild(i),e.addChild(t);var r=new egret.ScrollView;r.setContent(e),r.width=this.width,r.height=this.height,this.addChild(r)},t}(Page);__reflect(MailGetSuccessPage.prototype,"MailGetSuccessPage");var MailWritePage=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initedFlag=!1,t.mail=new Mail,t}return __extends(t,e),t.prototype.init=function(){var e=this;if(!this.initedFlag){this.initedFlag=!0;var t=new egret.Sprite,i=this.createBitmap("mail.bgwrite");t.width=i.width,t.height=i.height,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=this.width/2,t.y=this.height/2;var n=new egret.TextField;n.text="",n.width=200,n.height=30,n.size=32,n.verticalAlign=egret.VerticalAlign.MIDDLE,n.anchorOffsetY=n.height,n.textColor=0,n.x=200,n.y=330,n.type=egret.TextFieldType.INPUT;var a=new egret.TextField;a.text="",a.width=390,a.lineSpacing=10,a.height=350,a.multiline=!0,a.size=32,a.textColor=0,a.x=150,a.y=360,a.type=egret.TextFieldType.INPUT;var r=new egret.TextField;r.text="",r.width=130,r.height=30,r.size=32,r.verticalAlign=egret.VerticalAlign.MIDDLE,r.anchorOffsetY=r.height,r.textColor=0,r.x=418,r.y=745,r.type=egret.TextFieldType.INPUT;var o=new egret.TextField;o.text="",o.width=200,o.height=30,o.size=32,o.verticalAlign=egret.VerticalAlign.MIDDLE,o.anchorOffsetY=o.height,o.textColor=0,o.x=220,o.y=826,o.type=egret.TextFieldType.INPUT;var h=new egret.TextField;h.text="",h.width=200,h.height=30,h.size=32,h.verticalAlign=egret.VerticalAlign.MIDDLE,h.anchorOffsetY=h.height,h.textColor=0,h.x=309,h.y=880,h.type=egret.TextFieldType.INPUT;var l=this.createBitmap("mail.btnpic",!0);l.x=380,l.y=935,l.touchEnabled=!0,l.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){l.touchEnabled=!0,apiObj.uploadImg(function(t){console.log(t),e.mail.picUrl=t,e.createBitmapByUrl(t,function(e){console.log(t);var i=new egret.Shape;i.graphics.beginFill(0,1),i.graphics.drawRect(0,0,70,70),i.graphics.endFill(),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,e.width<e.height?e.scaleX=e.scaleY=70/e.width:e.scaleX=e.scaleY=70/e.height,e.x=l.x,e.y=l.y,i.x=e.x,i.y=e.y,e.mask=i,l.parent.addChild(i),l.parent.addChild(e)},!0)})},this);var s=this.createBtn("mail.btnwrite",function(){writeFlag=!0,e.mail.content=a.text,e.mail.to=n.text,e.mail.from=r.text,e.mail.city=h.text,e.mail.wechatId=o.text,apiObj.saveMail(e.mail,function(t){t?(d.touchEnabled=!0,s.touchEnabled=!0,e.onClose&&e.onClose(!0)):alert("保存失败！")})});s.x=t.width/2-20,s.y=t.height-20,t.addChild(i),t.addChild(n),t.addChild(a),t.addChild(r),t.addChild(o),t.addChild(h),t.addChild(s),t.addChild(l);var d=this.createBtn("mail.btnclose",function(){e.onClose&&e.onClose(),d.touchEnabled=!0});d.x=this.width-70,d.y=100,this.addChild(t),this.addChild(d)}},t}(Page);__reflect(MailWritePage.prototype,"MailWritePage");var ListPage=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){var e=this;apiObj.getListData(function(t){e.mailList=t,e.inited()})},t.prototype.inited=function(){var e=this,t=this.createBitmap("listbg");t.scaleX=t.scaleY=4,t.anchorOffsetX=t.width/2,t.x=.5*this.width;var i=this.createArm("listsky");i.x=this.width/2,i.y=.15*this.height,i.animation.play("float",-1),i.animation.timeScale=.3;var n=new egret.Sprite;n.width=4584,n.height=1373,n.anchorOffsetX=n.width/2,n.x=this.width/2,n.scaleX=n.scaleY=this.height/n.height,i.scaleX=i.scaleY=n.scaleY;for(var a=0;6>a;a++){var r=this.createBitmap("list.fg");r.x=764*a,n.addChild(r)}var o=this.createBitmap("list.pad",!0);o.anchorOffsetY=o.height,o.x=n.width/2,o.y=.95*n.height;var h=this.createArm("monsterbox");h.x=.5*n.width,h.y=.9*n.height,h.animation.timeScale=2,egret.Tween.get(h,{loop:!0}).call(function(){h.animation.play("run",-1)}).to({x:n.width+200},14500).call(function(){h.animation.stop("run")}).call(function(){h.animation.play("back",-1)}).to({y:n.height+200},1).to({x:.5*n.width,y:.9*n.height},15e3).call(function(){h.animation.stop("back")}).wait(500),n.addChild(this.createBoxes(n.width,n.height)),n.addChild(this.createClockBox(n.width,n.height)),n.addChild(h),n.addChild(o),n.addChild(this.createMontserBox(n.width,n.height));var l=null,s=null;this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(e){s=e.stageX,egret.Tween.removeTweens(n),l=n.x-25*p},this);var d=n.width*n.scaleX/2,c=-d+this.width,g=this.width/2;this.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(e){var t=e.stageX-s;g=l+t},this);var u=null,p=0,f=new egret.DeviceOrientation;f.addEventListener(egret.Event.CHANGE,function(e){var t=e.alpha;if(t>180&&(t=-(360-t)),null!=u||0!=t){if(null==u)u=t;else{var i=t-u;p=i}console.log(u)}},this),f.start();var m=new egret.Timer(1e3/this.stage.frameRate,-1);m.addEventListener(egret.TimerEvent.TIMER,function(){var e=g+25*p;e>d&&(e=d),c>e&&(e=c),egret.Tween.removeTweens(n),egret.Tween.removeTweens(t),egret.Tween.removeTweens(i),n.x!=e&&(egret.Tween.get(n).to({x:e},100),egret.Tween.get(t).to({x:.3*e},100),egret.Tween.get(i).to({x:.6*e},100))},this),m.start();var w=this.createBtn("list.btnback",function(){e.parent.removeChild(e)});w.x=w.anchorOffsetX+50,w.y=w.anchorOffsetX+80,this.addChild(t),this.addChild(i),this.addChild(n),this.addChild(w)},t.prototype.createBoxes=function(e,t){var i=this,n=new egret.DisplayObjectContainer;n.width=e,n.height=.4*this.height,n.y=.32*t,n.touchEnabled=!0,n.touchChildren=!0;var a=new egret.Point;n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(e){a.x=e.stageX,a.y=e.stageY},this),n.addEventListener(egret.TouchEvent.TOUCH_END,function(e){var t=e.target;t.hashCode!=n.hashCode&&(i.mailList.length>0&&(t.mail=i.mailList[0],i.mailList.shift()),Math.abs(a.x-e.stageX)>5||Math.abs(a.y-e.stageY)>5||CommonUtil.buttonTap(t,function(){return t.mail&&null!=t.mail?(i.parent.addChild(new MailGetPage(t.mail)),t.touchEnabled=!0,void(t.alpha=.3)):void alert("没有其他信了")}))},this);for(var r=[[147,196],[127,479],[362,157],[570,300],[562,515],[752,201],[769,461],[1005,510],[899,131],[1093,81],[1112,270],[1533,193],[1328,449],[1724,98],[1724,290],[1508,472],[2192,172],[1900,471],[2096,479],[2420,194],[2626,477],[2270,479],[2640,190],[2815,301],[2826,500],[3020,500],[2977,200],[3170,170],[3545,180],[3785,500],[4182,500],[3376,380],[3995,170],[3998,437],[4372,200],[4372,470],[3366,530]],o=0;o<r.length;o++){var h=this.createBitmap("list.E-mail-one_"+(10>o+1?"0"+(o+1):o+1),!0);h.x=r[o][0],h.y=r[o][1],h.touchEnabled=!0,n.addChild(h)}for(var l=[[338,446],[560,80],[930,326],[1322,151],[1685,512],[1961,170],[2433,473],[2807,120],[3348,170],[3764,192],[4179,215]],o=0;o<l.length;o++){var h=this.createMovieClip("E-mail-two_"+(10>o+1?"0"+(o+1):o+1)+"_01");h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,h.x=l[o][0],h.y=l[o][1],h.touchEnabled=!0,h.play(-1),h.frameRate=3,n.addChild(h)}return n},t.prototype.createMontserBox=function(e,t){var i=new egret.DisplayObjectContainer;i.width=e,i.height=.2*this.height,i.y=.85*t;var n=this.createArm("monsterred");n.x=i.width+200,n.y=.5*i.height,n.animation.timeScale=2,egret.Tween.get(n,{loop:!0}).call(function(){n.animation.play("run",-1)}).to({x:-200},1e4).call(function(){n.animation.stop("run"),n.animation.play("idle",-1)}).wait(500).call(function(){n.animation.play("back",-1)}).to({x:i.width+200},1e4);var a=this.createArm("monsteryellow");a.x=.25*i.width,a.y=.73*i.height,a.animation.timeScale=2,egret.Tween.get(a,{loop:!0}).call(function(){a.animation.play("run",-1)}).to({x:i.width+200},8e3).call(function(){a.animation.stop("run"),a.animation.play("back",-1)}).to({x:a.x},8e3);var r=this.createArm("monsterphone");r.x=.35*i.width,r.y=.4*i.height,r.animation.timeScale=2,egret.Tween.get(r,{loop:!0}).call(function(){r.animation.play("run",-1)}).to({x:i.width+200},15e3).call(function(){r.animation.stop("run"),r.animation.play("back",-1)}).to({x:r.x},15e3);var o=this.createArm("monsterwater");return o.x=.65*i.width,o.y=.5*i.height,egret.Tween.get(o,{loop:!0}).call(function(){o.animation.play("run",-1)}).to({x:0},15e3).call(function(){o.animation.stop("run"),o.animation.play("back",-1)}).to({x:o.x},15e3),i.addChild(n),i.addChild(o),i.addChild(r),i.addChild(a),i},t.prototype.createClockBox=function(e,t){var i=new egret.DisplayObjectContainer;i.width=e,i.y=.26*t;for(var n=0;5>n;n++){var a=this.createArm("listclock");a.x=766*(n+1),a.animation.gotoAndPlayByFrame("rotate",30*n,-1),a.animation.timeScale=.2,i.addChild(a)}return i},t}(Page);__reflect(ListPage.prototype,"ListPage");var OfficePage=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){var e=this,t=this.createBitmap("officebg");t.scaleY=this.height/t.height;var i=this.createBitmap("office.pad");i.anchorOffsetX=i.width/2,i.x=this.width/2,i.y=-i.height+100;var n=this.createArm("listclock");n.x=this.width/2,n.y=.12*this.height,n.animation.gotoAndPlayByFrame("rotate",0,-1);var a=this.createArm("listclock");a.x=n.x-150,a.scaleX=.5,a.skewX=-20,a.y=n.y,a.animation.gotoAndPlayByFrame("rotate",30,-1);var r=this.createArm("listclock");r.x=n.x+150,r.y=n.y,r.scaleX=.5,r.skewX=20,r.animation.gotoAndPlayByFrame("rotate",60,-1),n.animation.timeScale=a.animation.timeScale=r.animation.timeScale=.2,this.doAni=function(){var t=function(){egret.Tween.removeTweens(i),egret.Tween.get(i).to({y:0},500,egret.Ease.backIn).wait(5e3).to({y:-i.height+100},500,egret.Ease.backOut)};t(),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){egret.Tween.removeTweens(i),0==i.y?egret.Tween.get(i).to({y:-i.height+100},500,egret.Ease.backOut):t()},e)};var o=this.createMovieClip("mailfly"),h=function(){o.anchorOffsetX=215,o.anchorOffsetY=1115,o.x=215,o.y=.835*e.stage.stageHeight};h();var l=this.createArm("pop");l.x=this.width/2,l.y=.3*this.height,l.animation.play("float",-1);var s=this.createArm("doorlight");s.x=this.width/2,s.y=.3*this.height,s.animation.play("shua",-1),s.animation.timeScale=.5;var d=this.createArm("monsterred");d.x=this.width+200,d.y=.85*this.height,d.animation.timeScale=2,egret.Tween.get(d,{loop:!0}).call(function(){d.animation.play("run",-1)}).to({x:.5*this.width},2e3).call(function(){d.animation.stop("run"),d.animation.play("idle",-1)}).wait(500).call(function(){d.animation.play("back",-1)}).to({x:this.width+200},2e3);var c=this.createArm("monsterbox");c.x=.8*this.width,c.y=.95*this.height,c.animation.timeScale=2,egret.Tween.get(c,{loop:!0}).call(function(){c.animation.play("run",-1)}).to({x:this.width+200},4500).call(function(){c.animation.stop("run")}).call(function(){c.animation.play("back",-1)}).to({y:this.height+200},1).to({x:.8*this.width,y:.95*this.height},5e3).call(function(){c.animation.stop("back")}).wait(500);var g=this.createArm("monsteryellow");g.x=.75*this.width,g.y=.73*this.height,g.animation.timeScale=2,egret.Tween.get(g,{loop:!0}).call(function(){g.animation.play("run",-1)}).to({x:this.width+200},2e3).call(function(){g.animation.stop("run"),g.animation.play("back",-1)}).to({x:g.x},2e3);var u=this.createBtn("office.btnmore",function(){e.parent.addChild(new ListPage),u.touchEnabled=!0,e.showImgs("cbl_wait_",46,m,-1)});u.x=.63*this.width,u.y=.57*this.height,egret.Tween.get(u,{loop:!0}).to({y:u.y-20},1e3).to({y:u.y},1e3);var p=new MailWritePage;p.alpha=0,p.touchEnabled=!1,p.onClose=function(t){p.parent.removeChild(p),p.alpha=0,p.touchEnabled=!1,p.touchEnabled=!1,o.gotoAndStop(o.totalFrames-1);var i=new egret.Timer(1e3/o.frameRate,o.totalFrames-1);i.addEventListener(egret.TimerEvent.TIMER,function(){o.prevFrame()},e),t?i.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){e.showImgs("cbl_look_",40,m,1)},e):e.showImgs("cbl_wait_",46,m,-1),i.start(),hideMB()};var f=this.createBtn("office.btnwrite",function(){null!=p.parent&&p.parent.removeChild(p),e.parent.addChild(p),p.touchEnabled=!0,egret.Tween.get(o).to({anchorOffsetX:e.width/2,anchorOffsetY:667,x:e.width/2,y:e.height/2},300),o.play(1),o.once(egret.Event.COMPLETE,function(e){showMB(),egret.Tween.removeTweens(o),h(),p.alpha=1,o.gotoAndStop(0),f.touchEnabled=!0},e)});f.x=.5*this.width,f.y=.9*this.height,egret.Tween.get(f,{loop:!0}).to({y:f.y+20},1200).to({y:f.y},1300);var m=new egret.Sprite;this.addChild(t),this.addChild(l),this.addChild(s),this.addChild(d),this.addChild(c),this.addChild(g),this.addChild(m),this.addChild(u),this.addChild(f),this.addChild(a),this.addChild(r),this.addChild(n),this.addChild(i),this.addChild(o),this.showImgs("cbl_wait_",46,m,-1)},t.prototype.showImgs=function(e,t,i,n){var a=this;void 0===n&&(n=1),this.imgsTimer&&this.imgsTimer.stop();var r=1,o=-1;n>0&&(o=n*t);var h=new egret.Timer(1e3/6,o),l=function(){if(r>t)return void(r=1);i.removeChildren();for(var n=r.toString();n.length<2;)n="0"+n;var o=a.createBitmap(e+n);o.anchorOffsetY=o.height,o.y=a.height,i.addChild(o),r++};h.addEventListener(egret.TimerEvent.TIMER,l,this),l(),h.start(),this.imgsTimer=h},t}(Page);__reflect(OfficePage.prototype,"OfficePage");var CommonUtil=function(){function e(){}return e.buttonTap=function(e,t,i,n){RES.hasRes("buttonSound")&&playSound("buttonSound"),e.touchEnabled=!1,egret.Tween.removeTweens(e),egret.Tween.get(e).to({scaleX:e.scaleX-.2,scaleY:e.scaleY-.2},100).to({scaleX:e.scaleX,scaleY:e.scaleY},200).call(function(){n?t.apply(i,n):t()})},e.isExcellent=function(){return"iOS"!=egret.Capabilities.os&&"Windows PC"!=egret.Capabilities.os&&"Mac OS"!=egret.Capabilities.os||"webgl"!=egret.Capabilities.renderMode?!1:!0},e.sortRandomArray=function(e){e.sort(function(){return.5-Math.random()}),e.sort(function(){return.5-Math.random()}),e.sort(function(){return.5-Math.random()}),e.sort(function(){return.5-Math.random()})},e.ISDEBUGGING=!1,e}();__reflect(CommonUtil.prototype,"CommonUtil"),playSound=function(e,t,i){if(RES.hasRes(e)&&!soundManager.mute){(void 0==t||null==t)&&(t=1);try{var n=RES.getRes(e).play(0,t);return i&&null!=i&&n.addEventListener(egret.Event.SOUND_COMPLETE,i,null),n}catch(a){console.info(a)}}};var EUtil=function(){function e(){}return e.tear=function(t,i,n){var a=this;void 0===i&&(i=1);var r,o;if(e.tearCfg[t.hashCode.toString()]&&null!=e.tearCfg[t.hashCode.toString()])o=e.tearCfg[t.hashCode.toString()].box,r=e.tearCfg[t.hashCode.toString()].partArr;else{o=new egret.Sprite,o.width=t.width,o.height=t.height,o.scaleX=t.scaleX,o.scaleY=t.scaleY,o.rotation=t.rotation,o.anchorOffsetX=t.anchorOffsetX,o.anchorOffsetY=t.anchorOffsetY,o.x=t.x,o.y=t.y,r=[];for(var h=0,l=0;h<t.height;h+=l){l=Math.ceil(1+Math.ceil(5*Math.random())),h+l>t.height&&(l=t.height-h);var s=new egret.RenderTexture;s.drawToTexture(t,new egret.Rectangle(0,h,t.width,l));var d=new egret.Bitmap(s);d.y=h,d.filters=[],o.addChild(d),r.push(d)}e.tearCfg[t.hashCode.toString()]={},e.tearCfg[t.hashCode.toString()].box=o,e.tearCfg[t.hashCode.toString()].partArr=r}var c=function(){var e=t.parent.getChildIndex(t);t.parent.addChildAt(o,e),t.parent.removeChild(t);var h=1,l=function(){return i>0&&h++>i?(egret.Tween.removeTweens(o),o.parent.addChildAt(t,e),o.parent.removeChild(o),void(n&&n())):void 0},s=100+Math.random()+200;egret.Tween.get(o,{loop:!0}).call(l).wait(100).call(function(){for(var e=function(e){var t=r[e];egret.Tween.removeTweens(t),egret.Tween.get(t).to({x:t.x-50+100*Math.random(),alpha:.2+.8*Math.random()},.15*s).call(function(e){if(!(Math.random()>.5)){for(var t=[],i=0;20>i;i++)t.push(Math.random());e.filters.push(new egret.ColorMatrixFilter(t))}},a,[t]).to({x:t.x-20+40*Math.random(),alpha:.3+.7*Math.random()},.2*s).to({x:t.x-10+20*Math.random(),alpha:.3+.7*Math.random()},.1*s).call(function(){t.filters=[]}).to({x:t.x,alpha:t.alpha,scaleX:t.scaleX,scaleY:t.scaleY},s)},t=0;t<r.length;t++)e(t)}).wait(s/2).to({alpha:.5*o.alpha},50).wait(50).to({alpha:o.alpha},50).wait(s).call(l).wait(5*s)};t.parent&&null!=t.parent?c():t.once(egret.Event.ADDED_TO_STAGE,c,this)},e.tearCfg={},e}();__reflect(EUtil.prototype,"EUtil");var Box=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mail=null,t}return __extends(t,e),t}(egret.DisplayObject);__reflect(Box.prototype,"Box");var Timer=function(e){function t(t,i,n,a,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=2),void 0===a&&(a=null),void 0===r&&(r=null);var o=e.call(this,50,-1)||this;return o.beginTimeStamp=0,o.beginTime=0,o.currentTime=0,o.timerFunc=null,o.endTime=0,o.thisObj=null,o.decimalPoint=0,o.currentTime=t,o.thisObj=r,o.timerFunc=a,o.beginTime=t,o.endTime=i,o.decimalPoint=n,o.addEventListener(egret.TimerEvent.TIMER,o.timeTimerFunc,o),o}return __extends(t,e),t.prototype.start=function(){this.beginTimeStamp=(new Date).getTime(),e.prototype.start.call(this)},t.prototype.timeTimerFunc=function(){var e=Math.abs((this.beginTimeStamp-(new Date).getTime())/1e3),t="";t=this.endTime<0?e.toString():this.beginTime>this.endTime?(this.beginTime-e).toString():(this.endTime-e).toString(),t=parseFloat(t).toFixed(this.decimalPoint),this.decimalPoint>0&&"0"==t.substring(t.length-1)&&(t=t.substring(0,t.length-1)+"1"),this.currentTime.toString()!=t.toString()&&(this.currentTime=parseFloat(t),this.timerFunc.call(this.thisObj))},t}(egret.Timer);__reflect(Timer.prototype,"Timer");var Mail=function(){function e(){}return Object.defineProperty(e.prototype,"from",{get:function(){return this._from},set:function(e){this._from=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"to",{get:function(){return this._to},set:function(e){this._to=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headImgUrl",{get:function(){return this._headImgUrl},set:function(e){this._headImgUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"picUrl",{get:function(){return this._picUrl},set:function(e){this._picUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content
},set:function(e){this._content=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wechatId",{get:function(){return this._wechatId},set:function(e){this._wechatId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"city",{get:function(){return this._city},set:function(e){this._city=e},enumerable:!0,configurable:!0}),e}();__reflect(Mail.prototype,"Mail");