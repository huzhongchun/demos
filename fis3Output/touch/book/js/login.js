require(["book/js/public"],function(e){var t=e;t.setWxShareContent();var o=null,a=0,n=$(".hidden-refer-value").val();n=n?n:"/mobile/thefair/library_index";var s=$.getCookie("verifyCode");s&&parseInt(s)>0&&($(".check-btn").addClass("active"),$(".count-down-numb").show(),a=s,o=setInterval(function(){if(a--,a>0){var e=a/60/60/24;$(".count-down-numb").text(a),$(".count-down-tips").show(),$.setCookie("verifyCode",a,e,"/")}else clearInterval(o),$(".check-btn").removeClass("active"),$(".count-down-tips").hide();console.log(a)},1e3)),$(".check-btn").on("click",function(){if($(this).hasClass("active"))return!1;var e=$('input[name="mobile"]').val();return/^1[3|4|5|7|8]\d{9}$/.test(e)?($(this).addClass("active"),a=s>0?s:60,$(".count-down-numb").show(),o=setInterval(function(){if(a--,a>0){var e=a/60/60/24;$(".count-down-numb").text(a),$(".count-down-tips").show(),$.setCookie("verifyCode",a,e,"/")}else clearInterval(o),$(".check-btn").removeClass("active"),$(".count-down-tips").hide();console.log(a)},1e3),Thefair.addEventGa("library_login","click","mobile_"+e),void $.ajax({url:"/book/sms/get_verify_code",type:"post",data:{mobile:e},success:function(e){0==e.code||alert(e.message.text)},error:function(e){var t=JSON.parse(e.responseText);alert(t.message.text)}})):(alert("请输入正确的11位手机号~"),!1)}),$(".login-btn").on("click",function(){var e=this;if($(this).hasClass("active"))return!1;var t=$('input[name="mobile"]').val(),a=$('input[name="verify_code"]').val();return/^1[3|4|5|7|8]\d{9}$/.test(t)?a?($(this).addClass("active"),void $.ajax({url:"/book/sms/verify_code",type:"post",data:{mobile:t,code:a,type:""},success:function(t){0==t.code?window.location.href=n:(clearInterval(o),$(".count-down-tips").hide(),$(".check-btn").removeClass("active"),alert(t.message.text)),$(e).removeClass("active")},error:function(t){clearInterval(o),$(".count-down-tips").hide(),$(".check-btn").removeClass("active");var a=JSON.parse(t.responseText);alert(a.message.text),$(e).removeClass("active")}})):(alert("请输入验证码~"),!1):(alert("请输入正确的11位手机号~"),!1)})});