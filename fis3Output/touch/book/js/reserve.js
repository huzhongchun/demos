require(["book/js/public"],function(e){var o=e;o.setWxShareContent();var t=$.getCookie("verifyCodeVip");t&&parseInt(t)>0&&($(".check-btn").addClass("active"),_verifyCode=t,_loop=setInterval(function(){if(_verifyCode--,_verifyCode>0){var e=_verifyCode/60/60/24;$(".count-down-numb").text(_verifyCode),$(".count-down-tips").show(),$.setCookie("verifyCode",_verifyCode,e,"/")}else clearInterval(_loop),$(".check-btn").removeClass("active"),$(".count-down-tips").hide();console.log(_verifyCode)},1e3)),$(".check-btn").on("click",function(){if($(this).hasClass("active"))return!1;var e=$('input[name="mobile"]').val();return/^1[3|4|5|7|8]\d{9}$/.test(e)?($(this).addClass("active"),_verifyCode=t>0?t:60,_loop=setInterval(function(){if(_verifyCode--,_verifyCode>0){var e=_verifyCode/60/60/24;$(".count-down-numb").text(_verifyCode),$(".count-down-tips").show(),$.setCookie("verifyCodeVip",_verifyCode,e,"/")}else clearInterval(_loop),$(".check-btn").removeClass("active"),$(".count-down-tips").hide();console.log(_verifyCode)},1e3),Thefair.addEventGa("library_prev","click","mobile_"+e),void $.ajax({url:"/book/sms/get_sms_code",type:"post",data:{mobile:e},success:function(e){0==e.code||(clearInterval(_loop),$(".count-down-numb").hide(),$(".check-btn").removeClass("active"),alert(e.message.text))},error:function(e){clearInterval(_loop),$(".count-down-numb").hide(),$(".check-btn").removeClass("active");var o=JSON.parse(e.responseText);alert(o.message.text)}})):(alert("请输入正确的11位手机号~"),!1)}),$(".submit-btn").on("click",function(){var e=this,o=$('input[name="mobile"]').val(),t=$('input[name="verify_code"]').val();return/^1[3|4|5|7|8]\d{9}$/.test(o)?t.trim()?($(this).addClass("active"),void $.ajax({url:"/book/user/add_making_user",type:"post",data:{mobile:o,code:t},success:function(o){if(0==o.code){var t="<p>恭喜，预约成功！购买时间和链接我们将在活动开始前以短信的方式通知你。</p>";$(".prev-intro").html(t),$(".prev-area").hide()}else alert(o.message.text);$(e).removeClass("active")},error:function(o){var t=JSON.parse(o.responseText);alert(t.message.text),$(e).removeClass("active")}})):(alert("请输入验证码"),!1):(alert("请输入正确的11位手机号~"),!1)})});