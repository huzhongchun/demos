Jumei.widget("ui.fullScreenShow",{init:function(e){this.options={id:"full-screen-container",index:0,isShowTips:!0,tipsMessages:"向上滑动",backMaxLength:100,animateTime:.4,animateEndCallback:function(){}},this._super.call(this,e)},_create:function(){var e=this,a=this.options,i=$(window).height();a.direction=null,e.page={},e.$dom=$("#"+a.id),e.$dom.css({width:"320px",height:i,position:"relative",overflow:"hidden"});var n=e.$dom.children();n.css({position:"absolute",width:"100%",height:"100%",overflow:"hidden",left:0,top:0});var t=n.length;if(n.addClass("hide"),$(n[a.index]).addClass("active").removeClass("hide"),a.isShowTips){var s='<div class="tips">'+a.tipsMessages+"</div>";$("#wrapper").append(s),setTimeout(function(){var e=$(".tips").width();$(".tips").css("left",160-e/2+"px")},100)}e.$dom.on("touchstart",function(s){s.preventDefault(),e.page.startY=s.touches[0].pageY,e.page.movedY=0;var d=e.getTranslateArray();e.page.currentY=parseInt(d[1]),a.index=$(".active").index(),a.index!=t-1&&$(n[a.index+1]).addClass("z-index-high").removeClass("hide").css({"-webkit-transform":"translate3d(0px, "+i+"px, 0px)",transition:"all 0s ease 0s"}),0!=a.index&&$(n[a.index-1]).addClass("z-index-high").removeClass("hide").css({"-webkit-transform":"translate3d(0px, "+-i+"px, 0px)",transition:"all 0s ease 0s"})}),e.$dom.on("touchmove",function(s){s.preventDefault(),e.page.endY=s.touches[0].pageY,e.page.movedY=e.page.endY-e.page.startY,a.direction||(a.direction=e.page.movedY>0?"down":"up"),"down"==a.direction?0!=a.index&&$(n[a.index-1]).css("-webkit-transform","translate3d(0px, "+(-i+e.page.movedY)+"px, 0px)"):a.index!=t-1&&$(n[a.index+1]).css("-webkit-transform","translate3d(0px, "+(i+e.page.movedY)+"px, 0px)")}),e.$dom.on("touchend touchcancel",function(){var s=e.getTranslateArray();e.page.touchEndY=parseInt(s[1]),"down"==a.direction?0!=e.page.movedY&&0!=a.index&&(e.page.movedY>a.backMaxLength?($(n[a.index-1]).addClass("active").removeClass("z-index-high").css({"-webkit-transform":"translate3d(0px, 0px, 0px)",transition:"all "+a.animateTime+"s ease 0s"}),$(n[a.index]).removeClass("active"),n.off("webkitTransitionEnd"),$(n[a.index-1]).on("webkitTransitionEnd",function(i){if("transform"==i.propertyName){var n=a.index-1;a.animateEndCallback.call(e,n)}})):$(n[a.index-1]).css({"-webkit-transform":"translate3d(0px, "+-i+"px, 0px)",transition:"all "+a.animateTime+"s ease 0s"})):0!=e.page.movedY&&a.index!=t-1&&(e.page.movedY>-a.backMaxLength?$(n[a.index+1]).css({"-webkit-transform":"translate3d(0px, "+i+"px, 0px)",transition:"all "+a.animateTime+"s ease 0s"}):($(n[a.index]).removeClass("active"),$(n[a.index+1]).addClass("active").removeClass("z-index-high").css({"-webkit-transform":"translate3d(0px, 0px, 0px)",transition:"all "+a.animateTime+"s ease 0s"}),n.off("webkitTransitionEnd"),$(n[a.index+1]).on("webkitTransitionEnd",function(i){if("transform"==i.propertyName){var n=a.index+1;a.animateEndCallback.call(e,n)}}))),a.direction=null})},getTranslateArray:function(){var e,a=(this.options,$("#full-screen-container")),i=a.css("-webkit-transform");return e=i.indexOf("matrix")>-1||"none"==i?["0","0","0"]:$.trim(i).match(/-?\d*?.?\d*px/g)}});