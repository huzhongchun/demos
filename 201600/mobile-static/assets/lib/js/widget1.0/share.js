Jumei.widget("ui.share",{init:function(i){this.options={sinaBtnBg:"http://images.jumei.com/mobile/act/image/widget/share/weibo-btn.png",weichatBtnBg:"http://images.jumei.com/mobile/act/image/widget/share/wechat-btn.png",weiFriendBtnBg:"http://images.jumei.com/mobile/act/image/widget/share/weixin_friend.png",sinaLinkUrl:location.href,weiXinChatLinkUrl:location.href,weiXinFriendLinkUrl:location.href,sinaPic:"http://p0.jmstatic.com/templates/jumei/images/logo_new_v1.jpg",weiXinChatPic:"http://p0.jmstatic.com/templates/jumei/images/logo_new_v1.jpg",weiXinFriendPic:"http://p0.jmstatic.com/templates/jumei/images/logo_new_v1.jpg",sinaTitle:"精彩购物，尽在聚美优品",weixinChatTitle:"精彩购物，尽在聚美优品",weiXinFriendTitle:"精彩购物，尽在聚美优品",weiXinFriendContent:"中国最大正品化妆品团购网站，千万用户推荐，拆封30天无条件退款！",weiXinChatContent:"中国最大正品化妆品团购网站，千万用户推荐，拆封30天无条件退款！"},this._super.call(this,i)},_create:function(){var i=this,e=this.options;this.tpl='<div id="share-module-bg"></div><div id="share-module"><div id="share-module-wrapper"><a id="sina" class="sina" type="sina"><img src="'+e.sinaBtnBg+'"/></a><a id="wechat" class="wechat" type="wechat"><img src="'+e.weichatBtnBg+'"/></a><a id="weixin-friend"  class="weixin-friend" type="weixin-friend"><img src="'+e.weiFriendBtnBg+'"/></a><div style="clear:both;"></div></div><div class="close-share">取   消</div></div>',$("#share-module").length<=0?$("#wrapper").append(i.tpl):alert("默认的id命名“share-module”已经被使用了，快去调整一下之前的id名！"),this.bind(),this.close()},bind:function(){var i=this,e=$("#share-module-wrapper a");e.off("click"),e.on("click",function(){_gaq||_gaq.push(["_trackEvent","share","shareclick"]),_hmt||_hmt.push(["_trackEvent","share","shareclick"]);var e=$(this).attr("type"),n={};n.sinaLinkUrl=i.options.sinaLinkUrl,n.sinaTitle=i.options.sinaTitle,n.sinaPic=i.options.sinaPic,n.weiXinChatLinkUrl=i.options.weiXinChatLinkUrl,n.weixinChatTitle=i.options.weixinChatTitle,n.weiXinChatPic=i.options.weiXinChatPic,n.weiXinChatContent=i.options.weiXinChatContent,n.weiXinFriendLinkUrl=i.options.weiXinFriendLinkUrl,n.weiXinFriendPic=i.options.weiXinFriendPic,n.weiXinFriendTitle=i.options.weiXinFriendTitle,n.weiXinFriendContent=i.options.weiXinFriendContent;i._openUrl(e,n),i.close()});var n=$("#share-module .close-share");n.off("click"),n.on("click",function(){i.close()}),$("#share-module-bg").on("click",function(){i.close()})},_openUrl:function(i,e){var n=e,t="http://service.weibo.com/share/share.php?";switch(i){case"sina":_URL=t+"title="+encodeURIComponent(n.sinaTitle)+"&pic="+encodeURIComponent(n.sinaPic)+"&url="+encodeURIComponent(n.sinaLinkUrl);break;case"wechat":_URL="jumeimall://action/share/weixin?&link="+encodeURIComponent(n.weiXinChatLinkUrl)+"&img="+encodeURIComponent(n.weiXinChatPic)+"&title="+encodeURIComponent(n.weixinChatTitle)+"&des="+encodeURIComponent(n.weiXinChatContent);break;case"weixin-friend":_URL="jumeimall://action/share/weixin/pengyouquan?&link="+encodeURIComponent(n.weiXinFriendLinkUrl)+"&img="+encodeURIComponent(n.weiXinFriendPic)+"&title="+encodeURIComponent(n.weiXinFriendTitle)+"&des="+encodeURIComponent(n.weiXinFriendContent)}location.href=_URL},close:function(){$("#share-module").removeClass("share-show"),$("#share-module").addClass("share-hide"),$("#share-module-bg").hide()},show:function(){$("#share-module").addClass("share-show"),$("#share-module").removeClass("share-hide"),$("#share-module-bg").show()},openUrl:function(i,e){var n=this;return n._openUrl(i,e)}});