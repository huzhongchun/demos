!function(t){var e=function(t){var e=function(){};this.settings=$.extend({dom:$("#scroll-box"),pullDownCallback:e,pullUpCallback:e,startPullDownCallback:e,startPullDownMaxLength:40},t),this.init()};e.prototype={constructor:e,boxWidth:0,init:function(){var e=this,n=this.settings;if(e.time={},e.pageXY={},e.speed=0,e.direction=null,e.parentHeight=0,!n.dom||0==n.dom.length)return console.log("dom为空!"),!1;e.dom=n.dom.last();for(var o=e.dom.children(),a=0;a<o.length;a++){var r=t.getComputedStyle(o[a],null);if("content-box"==r.boxSizing){var s=parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth);e.boxWidth+=$(o[a]).width()+s}else if("border-box"==r.boxSizing){var i=parseFloat(r.paddingRight)+parseFloat(r.paddingLeft),s=parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth);e.boxWidth+=$(o[a]).width()+i+s}}e.dom.css("visibility","visible"),$(this.dom).width(e.boxWidth);var l=$(this.dom).parent();l.css("overflow","hidden"),e.addListener()},addListener:function(){var t=this,e=this.settings,n=t.pageXY;t.touchendFlag=!0;var o=$(t.dom);o.on("touchstart",function(e){t.time.startT=(new Date).getTime(),n.startX=e.touches[0].pageX,n.startY=e.touches[0].pageY;var o=t.getTranslateArray();n.currentX=parseInt(o[0]),n.currentY=parseInt(o[1]),t.stopMoveByCss(n.currentX),t.maxMove=t.getMaxMove()}),o.on("touchmove",function(a){n.endX=a.touches[0].pageX,n.endY=a.touches[0].pageY,n.movedX=n.endX-n.startX,n.movedY=n.endY-n.startY,t.direction=n.movedX>0?"right":"left",n.targetX=n.currentX+n.movedX,n.targetY=n.currentY+n.movedY,n.currentX<="0"&&n.targetX>0&&t.touchendFlag&&(e.startPullDownCallback(),t.touchendFlag=!1),n.currentX<=e.startPullDownMaxLength&&n.targetX>e.startPullDownMaxLength&&t.maxMove>0?o.css("-webkit-transform","translate3d( 40px, 0px,0px)"):t.maxMove>0&&(n.targetX<-(t.maxMove+e.startPullDownMaxLength)?o.css("-webkit-transform","translate3d("+-(e.startPullDownMaxLength+t.maxMove)+"px,0px,  0px)"):o.css("-webkit-transform","translate3d("+n.targetX+"px,0px, 0px)"))}),o.on("touchend",function(){var o,a,r;t.touchendFlag=!0;var s=t.getTranslateArray();n.touchEndX=parseInt(s[0]),n.touchEndY=parseInt(s[1]),t.time.endT=(new Date).getTime(),t.time.moveingT=t.time.endT-t.time.startT,n.moveLen=n.touchEndX-n.currentX,t.speed=Math.abs(n.moveLen/t.time.moveingT),o=t.time.moveingT/200,a=500*t.speed>5?500*t.speed:0,r="left"===t.direction?n.touchEndX-a:n.touchEndX+a,r>=e.startPullDownMaxLength&&(r=e.startPullDownMaxLength),r<-(t.maxMove+e.startPullDownMaxLength)&&(r=-(t.maxMove+e.startPullDownMaxLength)),t.moveByCss(o,r),t.monitor()})},getTranslateArray:function(){var e,n=$(this.dom),o=t.getComputedStyle(n[0])["-webkit-transform"].split(")")[0].split(", ");return e="none"===o[0]?["0","0","0"]:[o[12]||o[4],o[13]||o[5],"0"]},stopMoveByCss:function(t){var e=$(this.dom);e.css({"-webkit-transition":"-webkit-transform 0s ease-out 0s",transition:"-webkit-transform 0s ease-out 0s"}),e.css("-webkit-transform","translate3d("+t+"px, 0px, 0px)")},moveByCss:function(t,e){var n=(this.settings,$(this.dom));n.css({"-webkit-transition":"-webkit-transform "+t+"s cubic-bezier(0.333333,0.666667,0.66667,1) 0s",transition:"-webkit-transform "+t+"s cubic-bezier(0.333333,0.666667,0.66667,1) 0s"}),n.css("-webkit-transform","translate3d("+e+"px, 0px, 0px)")},offset:function(t){for(var e=0,n=0,o=t;o.offsetParent;)e+=o.offsetLeft,n+=o.offsetTop,o=o.offsetParent;return{left:e,top:n}},getMaxMove:function(){var t=this,e=(this.settings,$(t.dom).width()),n=e-$(this.dom).parent().width();return 0>n&&(n=0),n},monitor:function(){var t,e=this,n=this.settings,o=$(this.dom),a=setInterval(function(){var r=e.getTranslateArray(),s=parseInt(r[0]);s>0&&(e.stopMoveByCss(s),e.moveByCss("0.5",0),t=function(){n.pullDownCallback(),o.off("webkitTransitionEnd")},t(),clearInterval(a)),s<-e.maxMove&&(e.stopMoveByCss(s),e.moveByCss("0.5",-e.maxMove),t=function(){n.pullUpCallback(),o.off("webkitTransitionEnd")},t(),clearInterval(a))},100)}},F.addWidget("scrollXObject",e),define(function(){return e})}(window);