define(["view"],function(i){var t=['<div id="history-category-wrapper">','<div class="history-category-list" id="history-list-iscroll">',"</div>","</div>"].join(""),e=["<% var num = 0; %>",'<ul class="history-category-ul">',"<% for(var i = 0; i< data.length;i++){ var item = data[i][0];num = num+1; %>",'<li order_id="<%=item.dp_order_id%>">','<img src="<% if(item.image_url != "undefined"){ %><%=item.image_url%><% } %>"/>','<div class="list-content-content">','<div class="content-desc"><%=item.title%></div>','<div class="history-list-num">数量：<%=item.quantity%></div>','<div class="content-price">','<span class="consume-price history-price">价格：¥<%=item.total_amount%></span>',"</div>","</div>","</li>","<% } %>","</ul>","<% if(num == 0){ %>",'<div class="has-no-history">没有历史记录</div>',"<% } %>"].join(""),o=(['<div class="history-category-header" id="history-category-header">','<ul class="clear" id="history-category-ul">','<li class="history-header-select">全部</li>',"<li>未消费</li>","<li>退款中</li>","<li>已退款</li>","<li>已消费</li>","</ul>","</div>"].join(""),null),r=function(){$("#wrapper").loadding(),$.ajax({type:"get",dataType:"json",url:"/dp/getHistoryOrders",success:function(i){if(i){var t={data:i},r=Jumei.parseTpl(e,t);$("#history-list-iscroll").html(r),o.refresh()}$("#wrapper").loadding("close")},error:function(){$("#wrapper").loadding("close")}})};return Jumei.create(i,{onCreate:function(){o=this,this.elem.html(t),r()},setTitle:function(){this.title("团购历史")},onRefresh:function(){this.setTitle()},onEvent:function(){var i=this;this.events={"click .history-category-ul li":function(){i.forward("#module=beauty&action=my_group&order_id="+$(this).attr("order_id")+"&latitude="+o.param.latitude+"&longitude="+o.param.longitude)},"click .icon_home":function(){window.location="../index.html"}}},initNavScroll:function(){new IScroll("#history-category-header",{scrollX:!0,scrollY:!1,mouseWheel:!0})},onShow:function(){},onClose:function(){}})});