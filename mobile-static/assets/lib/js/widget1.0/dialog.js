Jumei.widget("ui.dialog",{init:function(i){this.options={element:"element",width:260,height:200,content:"聚美提示您！",title:"提示",type:"default",btn:2,ok:"确定",cancel:"取消",init:function(){},okCallback:null,cancelCallback:function(){}},this.tpl='<div class="ui-dialog"><div class="ui-dialog-title"><div><%=title%></div><div class="ui-dialog-close"></div></div><div class="ui-dialog-content"><%=content%></div><% if(btn == 2){  %><div class="ui-dialog-btn"><div class="ui-dialog-cancel"><%=cancel%></div><div class="ui-dialog-ok"><%=ok%></div></div><% }else if(btn == 1){ %><div class="ui-dialog-btn"><div class="ui-dialog-ok" style="border-left: none;width: 100%;" ><%=ok%></div></div><% } %></div>',this.bg='<div class="ui-bg"></div>',this._super.call(this,i)},_create:function(){this._appendHtml(),this._initFunc(),this._bindEvent(),this._resize()},_appendHtml:function(){var i=this,t=$(".ui-bg"),a=$("body"),o=Jumei.parseTpl(this.tpl,this.options);this.dialog=$(o),$("#wrapper").append(i.dialog),t.length<=0&&a.append(i.bg)},_initFunc:function(){this.options.init()},show:function(){var i=$("body").height(),t=$(window).height()*Jumei.scale,a=i>t?i:t;$(".ui-bg").css({position:"absolute",height:a+"px"}),this._culculate(),this._setFlag(),this._animateShow()},_animateShow:function(){var i=$(".ui-bg"),t=this.options.type;switch(i.show(),i.animate({opacity:.5},500,"ease-out"),t){case"slidedown":this.dialog.show(),this.dialog.css({transform:"translate3d(0,-300px,0)","-webkit-transform":"translate3d(0,-300px,0)"}),this.dialog.animate({transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)",opacity:1},300,"ease");break;case"rotate":this.dialog.show(),this.dialog.wrap('<div class="ui-dialog-wrap"></div>'),this.dialog.css({transform:"rotateY(-390deg)","-webkit-transform":"rotateY(-390deg)"}),this.dialog.animate({transform:"rotateY(0deg)","-webkit-transform":"rotateY(0deg)"},500,"ease");break;case"scale":this.dialog.show(),this.dialog.css({transform:"scale(0)","-webkit-transform":"scale(0)"}),this.dialog.animate({transform:"scale(1)","-webkit-transform":"scale(1)"},200,"ease",function(){});break;case"fadein":this.dialog.show(),this.dialog.css("opacity",0),this.dialog.animate({opacity:1},400,"ease",function(){});break;default:this.dialog.show(),i.show(),i.animate({opacity:.5},500,"ease")}},_bindEvent:function(){var i=this,t=$(".ui-dialog-btn .ui-dialog-cancel,.ui-dialog .ui-dialog-close"),a=$(".ui-dialog .ui-dialog-ok");t&&t.click(function(){return i.hide(),i.options.cancelCallback(),!1}),a&&a.click(function(){var t=!0;return"function"==typeof i.options.okCallback&&(t=i.options.okCallback()),t!==!1&&i.hide(),!0}),$(document).on("touchmove",".ui-dialog,.ui-bg",function(i){i.preventDefault()})},_resize:function(){},_culculate:function(){var i=this;i.windowHeight=$(window).height(),i.windowWidth=320,i.dialog.show(),i.height=i.dialog.height(),i.dialog.hide()},_setFlag:function(){var i=0,t=0,a=0;this.dialog.width(this.options.width),i=$(window).scrollTop(),a=(this.windowWidth-this.options.width)/2,t=(this.windowHeight-this.height)/2+i,this.dialog.css({left:a+"px",top:t+"px"})},hide:function(){$(".ui-bg").hide(),this.dialog.hide()}});