Jumei.widget("ui.upslide",{init:function(e){this.options={pic:"",title:"聚美",link_url:"http://d.jumei.com"},this._super.call(this,e)},_create:function(){var e=$(window).width(),i=$(window).height(),t=$(this.element),n=t.children();t.width(e),t.height(i),n.height(i),n.each(function(e){$(this).css({position:"absolute",width:"100%","z-index":n.length-e})}),this.options.windowHeight=i,this.initEvent()},initEvent:function(){var e=this.options,i=this,t=e.wheel=this.element;e.index=0,e.height=$(window).height(),e.length=$(t).children().length;var n=e.childrenArr=t.querySelectorAll("li");n[e.index].style.display="block",t.addEventListener("touchstart",function(i){e.pageX=i.touches[0].pageX,e.pageY=i.touches[0].pageY,e.S=!1,e.T=!1,e.X=0,e.Y=0}),t.addEventListener("touchmove",function(i){var t=e.Y=i.touches[0].pageY-e.pageY;if(!e.T){var s=Math.abs(t)<Math.abs(i.touches[0].pageY-e.pageY);s||clearTimeout(e.play),e.T=!0,e.S=s}e.S||(i.stopPropagation(),i.preventDefault(),Math.abs(t)<1e3&&(t>0&&e.index>0?(e.index-1>=0&&(n[e.index-1].style.display="block",n[e.index-1].style.webkitTransitionDuration="0ms",n[e.index-1].style.webkitTransform="translate3d(0,"+(-e.windowHeight+t)+"px,0)"),e.index+1<=e.length-1&&(n[e.index+1].style.display="none"),n[e.index].style.webkitTransitionDuration="0ms",n[e.index].style.webkitTransform="scale("+(1-Math.abs(t)/e.windowHeight*.5)+")",n[e.index].style.opacity=1-Math.abs(t)/e.windowHeight*1):0>t&&e.index<e.length-1&&(e.index-1>=0&&(n[e.index-1].style.display="none"),e.index+1<=e.length-1&&(n[e.index+1].style.display="block",n[e.index+1].style.webkitTransitionDuration="0ms",n[e.index+1].style.webkitTransform="scale("+(.5+Math.abs(t)/e.windowHeight*.5)+")",n[e.index+1].style.opacity=Math.abs(t)/e.windowHeight*1),n[e.index].style.webkitTransitionDuration="0ms",n[e.index].style.webkitTransform="translate3d(0,"+t+"px,0)")))});var s=function(){Math.abs(e.Y)>20&&(e.S||i.slide(n[e.index],e.index+(e.Y<=-20?Math.ceil(-e.Y/e.height):e.Y>20?-Math.ceil(e.Y/e.height):0)))};t.addEventListener("touchend",s),t.addEventListener("touchcancel",s);for(var a=0;a<n.length;a++)n[a].addEventListener("webkitTransitionEnd",function(){n[e.index].style.display="block"})},slide:function(e,i){var t=this.options,n=this,s=t.length;e>-1&&s>e?n.move(e):e>=s?(n.move(s-(i?2:1)),t._direction=-1):(n.move(i?1:0),t._direction=1)},move:function(){var e=this.options,i=e.childrenArr,t=e.index;e.Y<0&&t!=e.length-1?(i[e.index].style.webkitTransitionDuration="400ms",i[e.index].style.webkitTransform="translate3d(0,-"+e.windowHeight+"px,0)",i[e.index].style.opacity=0,e.index+=e.Y>0?-1:1,i[e.index].style.webkitTransitionDuration="400ms",i[e.index].style.webkitTransform="translate3d(0,0px,0) scale(1)",i[e.index].style.opacity=1):e.Y>0&&0!=t&&(i[e.index].style.webkitTransitionDuration="400ms",i[e.index].style.opacity=0,e.index+=e.Y>0?-1:1,i[e.index].style.webkitTransitionDuration="400ms",i[e.index].style.webkitTransform="translate3d(0,0px,0) scale(1)",i[e.index].style.opacity=1)}});