Jumei.widget("ui.imglazyload",{init:function(t){this.options={threshold:0,container:window,urlName:"data-url",placeHolder:"",eventName:"scrollStop",innerScroll:!1,isVertical:!0,classSelector:"img"},this.pedding=[],this._super.call(this,t)},_create:function(){this.initElem(),this.initEvent()},isShow:function(t){var i=$(this.options.container),e=this.options.isVertical,n=$.isWindow(i.get(0)),o={win:[e?"scrollY":"scrollX",e?"innerHeight":"innerWidth"],img:[e?"top":"left",e?"height":"width"]},s=n?window:i.offset(),r=s[o.win[0]],a=s[o.win[1]],c=!0;return c=r>=t[o.img[0]]-this.options.threshold-a&&r<=t[o.img[0]]+t[o.img[1]]?!0:!1},initElem:function(){var t=this.options,i=this;$(t.classSelector).each(function(){i.pedding.push(this),t.placeHolder.length>0&&$(this).attr("src",t.placeHolder)})},initEvent:function(){var t=this;$(function(){t.detect(),setTimeout(function(){t.detect()},500)}),$(window).on(this.options.eventName+" ortchange",function(){t.pedding.length<=0?$(window).off(t.options.eventName+" ortchange"):t.detect()})},load:function(t){var i=$(t),e={},n=i,o=this,s=$(t).is("img"),r="";s||($.each(i.get(0).attributes,function(){~this.name.indexOf("data-")&&(e[this.name]=this.value)}),n=$("<img />").attr(e)),i.trigger("startload"),n.on("load",function(){n.css({opacity:1}),!s&&i.replaceWith(n),i.trigger("loadcomplete"),n.off("load")}).on("error",function(){n.off("error").remove()}),r=i.attr(o.options.urlName),r&&""!==r&&n.attr("src",r)},detect:function(){var t,i,e,n,o=this,s=[].splice;for(t=o.pedding.length;t--;)i=$(n=o.pedding[t]),e=i.offset(),$(n).css({opacity:0,"-webkit-transition":"all 350ms ease"}),o.isShow(e)&&(s.call(o.pedding,t,1),o.load(n))}});